var t=Object.defineProperty,e=Object.prototype.hasOwnProperty,o=Object.getOwnPropertySymbols,a=Object.prototype.propertyIsEnumerable,s=(e,o,a)=>o in e?t(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,n=(t,n)=>{for(var l in n||(n={}))e.call(n,l)&&s(t,l,n[l]);if(o)for(var l of o(n))a.call(n,l)&&s(t,l,n[l]);return t};import{U as l,S as r,i as d,s as c,e as i,k as u,c as h,a as m,n as p,d as f,b as v,E as g,f as b,F as y,V as j,W as w,X as E,Y as O,O as x,Q as T,t as M,T as k,g as N,Z as U,u as _,v as F,r as I,N as P,B,_ as D,H as R}from"../../chunks/vendor-6d669ea2.js";import{c as $,s as S}from"../../chunks/index-c7686ce4.js";function H(t,{pending:e,error:o,result:a}){let s;async function n(n){const l=s={};n.preventDefault();const r=new FormData(t);e&&e(r,t);try{const e=await fetch(t.action,{method:t.method,headers:{accept:"application/json"},body:r});if(l!==s)return;e.ok?a(e,t):o?o(e,null,t):console.error(await e.text())}catch(d){if(!o)throw d;o(null,d,t)}}return t.addEventListener("submit",n),{destroy(){t.removeEventListener("submit",n)}}}function V(t,e,o={}){const a=getComputedStyle(t),s="none"===a.transform?"":a.transform,n=e.from.width/t.clientWidth,r=e.from.height/t.clientHeight,d=(e.from.left-e.to.left)/n,c=(e.from.top-e.to.top)/r,i=Math.sqrt(d*d+c*c),{delay:u=0,duration:h=(t=>120*Math.sqrt(t)),easing:m=$}=o;return{delay:u,duration:l(h)?h(i):h,easing:m,css:(t,e)=>`transform: ${s} translate(${e*d}px, ${e*c}px);`}}function q(t,e,o){const a=t.slice();return a[5]=e[o],a}function C(t,e){let o,a,s,n,r,d,c,M,k,N,U,_,F,I,B,D,$,q,C,L,W,Q,X,Y,Z,z,A,G=R;function J(...t){return e[3](e[5],...t)}function K(){return e[4](e[5])}return{key:t,first:null,c(){o=i("div"),a=i("form"),s=i("input"),r=u(),d=i("button"),N=u(),U=i("form"),_=i("input"),I=u(),B=i("button"),$=u(),q=i("form"),C=i("button"),Q=u(),this.h()},l(t){o=h(t,"DIV",{class:!0});var e=m(o);a=h(e,"FORM",{action:!0,method:!0});var n=m(a);s=h(n,"INPUT",{type:!0,name:!0,value:!0,class:!0}),r=p(n),d=h(n,"BUTTON",{class:!0,"aria-label":!0}),m(d).forEach(f),n.forEach(f),N=p(e),U=h(e,"FORM",{class:!0,action:!0,method:!0});var l=m(U);_=h(l,"INPUT",{type:!0,name:!0,value:!0,class:!0}),I=p(l),B=h(l,"BUTTON",{class:!0,"aria-label":!0}),m(B).forEach(f),l.forEach(f),$=p(e),q=h(e,"FORM",{action:!0,method:!0});var c=m(q);C=h(c,"BUTTON",{class:!0,"aria-label":!0}),m(C).forEach(f),c.forEach(f),Q=p(e),e.forEach(f),this.h()},h(){v(s,"type","hidden"),v(s,"name","done"),s.value=n=e[5].done?"":"true",v(s,"class","svelte-mhdm0p"),v(d,"class","toggle svelte-mhdm0p"),v(d,"aria-label",c="Mark todo as "+(e[5].done?"not done":"done")),v(a,"action",M="/todos/"+e[5].uid+".json?_method=patch"),v(a,"method","post"),v(_,"type","text"),v(_,"name","text"),_.value=F=e[5].text,v(_,"class","svelte-mhdm0p"),v(B,"class","save svelte-mhdm0p"),v(B,"aria-label","Save todo"),v(U,"class","text svelte-mhdm0p"),v(U,"action",D="/todos/"+e[5].uid+".json?_method=patch"),v(U,"method","post"),v(C,"class","delete svelte-mhdm0p"),v(C,"aria-label","Delete todo"),v(q,"action",L="/todos/"+e[5].uid+".json?_method=delete"),v(q,"method","post"),v(o,"class","todo svelte-mhdm0p"),g(o,"done",e[5].done),this.first=o},m(t,n){b(t,o,n),y(o,a),y(a,s),y(a,r),y(a,d),y(o,N),y(o,U),y(U,_),y(U,I),y(U,B),y(o,$),y(o,q),y(q,C),y(o,Q),Z=!0,z||(A=[j(k=H.call(null,a,{pending:J,result:e[1]})),j(H.call(null,U,{result:e[1]})),j(W=H.call(null,q,{result:K}))],z=!0)},p(t,r){e=t,(!Z||1&r&&n!==(n=e[5].done?"":"true"))&&(s.value=n),(!Z||1&r&&c!==(c="Mark todo as "+(e[5].done?"not done":"done")))&&v(d,"aria-label",c),(!Z||1&r&&M!==(M="/todos/"+e[5].uid+".json?_method=patch"))&&v(a,"action",M),k&&l(k.update)&&1&r&&k.update.call(null,{pending:J,result:e[1]}),(!Z||1&r&&F!==(F=e[5].text)&&_.value!==F)&&(_.value=F),(!Z||1&r&&D!==(D="/todos/"+e[5].uid+".json?_method=patch"))&&v(U,"action",D),(!Z||1&r&&L!==(L="/todos/"+e[5].uid+".json?_method=delete"))&&v(q,"action",L),W&&l(W.update)&&1&r&&W.update.call(null,{result:K}),1&r&&g(o,"done",e[5].done)},r(){Y=o.getBoundingClientRect()},f(){w(o),G(),E(o,Y)},a(){G(),G=O(o,Y,V,{duration:200})},i(t){Z||(t&&P((()=>{X||(X=x(o,S,{start:.7},!0)),X.run(1)})),Z=!0)},o(t){t&&(X||(X=x(o,S,{start:.7},!1)),X.run(0)),Z=!1},d(t){t&&f(o),t&&X&&X.end(),z=!1,T(A)}}}function L(t){let e,o,a,s,n,r,d,c,g,w,E,O,x=[],T=new Map,P=t[0];const R=t=>t[5].uid;for(let l=0;l<P.length;l+=1){let e=q(t,P,l),o=R(e);T.set(o,x[l]=C(o,e))}return{c(){e=u(),o=i("div"),a=i("h1"),s=M("Todos"),n=u(),r=i("form"),d=i("input"),g=u();for(let t=0;t<x.length;t+=1)x[t].c();this.h()},l(t){k('[data-svelte="svelte-181o7gf"]',document.head).forEach(f),e=p(t),o=h(t,"DIV",{class:!0});var l=m(o);a=h(l,"H1",{});var c=m(a);s=N(c,"Todos"),c.forEach(f),n=p(l),r=h(l,"FORM",{class:!0,action:!0,method:!0});var i=m(r);d=h(i,"INPUT",{name:!0,placeholder:!0,class:!0}),i.forEach(f),g=p(l);for(let e=0;e<x.length;e+=1)x[e].l(l);l.forEach(f),this.h()},h(){document.title="Todos",v(d,"name","text"),v(d,"placeholder","+ tap to add a todo"),v(d,"class","svelte-mhdm0p"),v(r,"class","new svelte-mhdm0p"),v(r,"action","/todos.json"),v(r,"method","post"),v(o,"class","todos svelte-mhdm0p")},m(l,i){b(l,e,i),b(l,o,i),y(o,a),y(a,s),y(o,n),y(o,r),y(r,d),y(o,g);for(let t=0;t<x.length;t+=1)x[t].m(o,null);w=!0,E||(O=j(c=H.call(null,r,{result:t[2]})),E=!0)},p(t,[e]){if(c&&l(c.update)&&1&e&&c.update.call(null,{result:t[2]}),3&e){P=t[0],B();for(let t=0;t<x.length;t+=1)x[t].r();x=U(x,e,R,1,t,P,T,o,D,C,null,q);for(let t=0;t<x.length;t+=1)x[t].a();_()}},i(t){if(!w){for(let t=0;t<P.length;t+=1)F(x[t]);w=!0}},o(t){for(let e=0;e<x.length;e+=1)I(x[e]);w=!1},d(t){t&&f(e),t&&f(o);for(let e=0;e<x.length;e+=1)x[e].d();E=!1,O()}}}const W=async({fetch:t})=>{const e=await t("/todos.json");if(e.ok){return{props:{todos:await e.json()}}}const{message:o}=await e.json();return{error:new Error(o)}};function Q(t,e,o){let{todos:a}=e;return t.$$set=t=>{"todos"in t&&o(0,a=t.todos)},[a,async function(t){const e=await t.json();o(0,a=a.map((t=>t.uid===e.uid?e:t)))},async(t,e)=>{const s=await t.json();o(0,a=[...a,s]),e.reset()},(t,e)=>{const s=!!e.get("done");o(0,a=a.map((e=>e===t?n(n({},e),{done:s}):e)))},t=>{o(0,a=a.filter((e=>e.uid!==t.uid)))}]}export default class extends r{constructor(t){super(),d(this,t,Q,L,c,{todos:0})}}export{W as load};
